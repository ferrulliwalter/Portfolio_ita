<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Portfolio – Walter</title>
  <meta name="description" content="Portfolio progetti – sito vetrina one‑page senza menu." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b120e; --fg:#f4f8f5; --muted:#a8bfb1; --card:#122019; --accent:#2fb369;
      --radius:20px; --shadow:0 10px 30px rgba(0,0,0,.25);
    }
    *{box-sizing:border-box}
    html,body{margin:0; padding:0; background:var(--bg); color:var(--fg); font-family:'Open Sans', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;}
    a{color:inherit}
    .wrap{max-width:1100px; margin:0 auto; padding:28px;}
    header{display:flex; align-items:center; justify-content:space-between; gap:16px; padding:32px 0;}
    .id{display:flex; gap:18px; align-items:center}
    .avatar{width:64px; height:64px; border-radius:50%; object-fit:cover; box-shadow:0 4px 16px rgba(0,0,0,.25);} 
    h1{font-size:32px; line-height:1.1; margin:0}
    .sub{color:var(--muted); margin-top:6px; font-size:15px}
    .cta{display:flex; gap:10px; flex-wrap:wrap; align-items:center;}
    .btn{appearance:none; border:none; padding:12px 16px; border-radius:12px; background:var(--accent); color:white; cursor:pointer; box-shadow:var(--shadow); font-family:'Open Sans', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; font-weight:400; font-size:15px;}
    .btn.ghost{background:transparent; border:1px solid #2a2f39; color:var(--fg);}

    .hero{background:linear-gradient(135deg, rgba(47,179,105,.15), transparent 60%); padding:26px; border-radius:var(--radius); box-shadow:var(--shadow)}

    .controls{display:flex; gap:12px; align-items:center; justify-content:flex-end; margin:18px 0}
    .toggle{background:#1a1f27; padding:6px; border-radius:99px; display:flex; gap:6px}
    .toggle button{padding:8px 12px; border-radius:99px; border:none; background:transparent; color:var(--muted); cursor:pointer}
    .toggle button.active{background:var(--accent); color:white}

    /* Mosaic grid */
    .grid{display:grid; grid-template-columns:repeat(3,1fr); gap:16px}
    @media (max-width:900px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:560px){.grid{grid-template-columns:1fr}}
    .card{background:var(--card); border-radius:16px; overflow:hidden; box-shadow:var(--shadow); display:flex; flex-direction:column}
    .card img{width:100%; aspect-ratio:16/10; object-fit:cover}
    .card .body{padding:14px}
    .card h3{margin:0 0 6px; font-size:18px}
    .meta{display:flex; gap:8px; flex-wrap:wrap; margin-top:8px}
    .tag{font-size:12px; color:#d2d7e0; background:#242a34; padding:6px 8px; border-radius:999px}

    /* Slide viewer */
    .slides{display:none; position:relative; background:var(--card); border-radius:16px; overflow:hidden; box-shadow:var(--shadow)}
    .slides.active{display:block}
    .slide-img{width:100%; height:380px; object-fit:cover; display:block}
    .slide-img.contain{object-fit:contain; background:#0f1412;}
    .slide-info{display:flex; justify-content:space-between; align-items:center; padding:12px 14px}
    .nav{position:absolute; top:50%; transform:translateY(-50%); width:100%; display:flex; justify-content:space-between; padding:0 8px}
    .nav button{border:none; width:44px; height:44px; border-radius:50%; background:rgba(0,0,0,.35); color:#fff; font-size:18px; cursor:pointer}

    .flag{display:inline-grid; place-items:center; width:36px; height:36px; border-radius:50%; text-decoration:none; box-shadow:var(--shadow); background:transparent; padding:0;}
    .flag svg{width:36px; height:36px; display:block; border-radius:50%; overflow:hidden;}
    .flag:hover{transform:translateY(-1px)}
    footer{color:var(--muted); text-align:center; padding:36px 0}
    .links{display:flex; gap:12px; justify-content:center; flex-wrap:wrap}

    /* Lightbox (stili residui, non usata) */
    .lightbox{position:fixed; inset:0; background:rgba(0,0,0,.75); display:none; align-items:center; justify-content:center; padding:20px;}
    .lightbox.open{display:flex}
    .lightbox img{max-width:90vw; max-height:80vh; border-radius:16px; box-shadow:var(--shadow)}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="id">
        <img class="avatar" src="image_1.jpg" alt="Foto di Walter" />
        <div>
          <h1>Walter – Portfolio</h1>
          <div class="sub">Una selezione dei miei lavori</div>
        </div>
      </div>
      <div class="cta">
        <a class="btn ghost" href="./CV_WalterFerrulli.pdf" target="_blank" rel="noopener">Scarica CV</a>
        <button class="btn" id="contactBtn" aria-haspopup="dialog">Contatti</button>
        <!-- IT flag (inline SVG, no external assets needed) -->
        <a class="flag" href="https://ferrulliwalter.github.io/Portfolio_ita/" target="_blank" rel="noopener" aria-label="Italiano">
          <svg viewBox="0 0 36 36" xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true">
            <defs><clipPath id="r"><circle cx="18" cy="18" r="18"/></clipPath></defs>
            <g clip-path="url(#r)">
              <rect width="36" height="36" fill="#fff"/>
              <rect width="12" height="36" x="0" fill="#009246"/>
              <rect width="12" height="36" x="24" fill="#CE2B37"/>
            </g>
          </svg>
        </a>
        <!-- GB flag (Union Jack, stroke-based for clarity) -->
        <a class="flag" href="https://ferrulliwalter.github.io/Portfolio_eng/" target="_blank" rel="noopener" aria-label="English">
          <svg viewBox="0 0 36 36" xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true">
            <defs><clipPath id="c"><circle cx="18" cy="18" r="18"/></clipPath></defs>
            <g clip-path="url(#c)">
              <rect width="36" height="36" fill="#012169"/>
              <!-- white diagonals -->
              <g stroke="#FFF" stroke-width="8" stroke-linecap="square">
                <path d="M0 0 L36 36"/>
                <path d="M36 0 L0 36"/>
              </g>
              <!-- red diagonals -->
              <g stroke="#C8102E" stroke-width="4" stroke-linecap="square">
                <path d="M0 0 L36 36"/>
                <path d="M36 0 L0 36"/>
              </g>
              <!-- central cross white -->
              <rect x="0" y="14" width="36" height="8" fill="#FFF"/>
              <rect x="14" y="0" width="8" height="36" fill="#FFF"/>
              <!-- central cross red -->
              <rect x="0" y="16" width="36" height="4" fill="#C8102E"/>
              <rect x="16" y="0" width="4" height="36" fill="#C8102E"/>
            </g>
          </svg>
        </a>
      </div>
    </header>

    <section class="hero" aria-label="Progetti">
      <div class="controls">
        <div class="toggle" role="tablist" aria-label="Vista galleria">
          <button id="mosaicBtn" role="tab" aria-selected="true" class="active">Mosaico</button>
          <button id="slideBtn" role="tab" aria-selected="false">Slideshow</button>
        </div>
      </div>

      <!-- MOSAICO -->
      <div id="mosaic" class="grid" aria-live="polite"></div>

      <!-- SLIDESHOW -->
      <div id="slides" class="slides" aria-live="polite" aria-label="Slideshow progetti">
        <img id="slideImage" class="slide-img" alt="Anteprima progetto" src="" />
        <div class="nav" aria-hidden="false">
          <button id="prev" aria-label="Progetto precedente">◀</button>
          <button id="next" aria-label="Progetto successivo">▶</button>
        </div>
        <div class="slide-info">
          <div>
            <strong id="slideTitle">Titolo</strong>
            <div id="slideDesc" style="color:var(--muted); font-size:14px"></div>
          </div>
        </div>
      </div>
    </section>

    <footer>
      <div>© <span id="year"></span> Walter. Tutti i diritti riservati.</div>
      <div class="links" aria-label="Link social">
        <a href="mailto:ferrulli.walter@gmail.com">ferrulli.walter@gmail.com</a>
        <span>·</span>
        <a href="https://www.linkedin.com/in/walter-ferrulli/" target="_blank" rel="noopener">LinkedIn</a>
      </div>
    </footer>
  </div>

  <script>
    // ======= DATI PROGETTI =======
    // desc: 2 righe per mosaico; full: testo completo (ITA) per slideshow
    const projects = [
      {
        title: "Customer Data Platform – Produttore di fragranze tedesco",$1image: "image_2.png", fit: "contain",
        link: "#",
        tags: ["CDP", "Data Hub", "BI", "MMM/NBA", "Customer Analytics"],
        keywords: ["Customer Data Platform","CDP","Business Intelligence","Next Best Action","Marketing Mix Modeling","data hub","engagement","cross‑country"]
      },
      {
        title: "Geointelligence – Brand automotive globale",
        desc: "Suite GeoIntelligence per governance rete multi‑brand/paese: analisi copertura, benchmark performance, simulazioni greenfield e scenario.",
        full: "Ho progettato e implementato una soluzione avanzata di Geointelligence per ottimizzare la governance della rete di un gruppo automotive globale multi‑brand e multi‑paese. L'iniziativa ha integrato una suite leader di mercato per abilitare analisi di copertura, benchmark di performance e location intelligence. Sono stati integrati KPI real‑time, analisi competitor e simulazioni greenfield/scenario. La data strategy ha garantito ingestion, processing e visualizzazione consistenti tra regioni, combinando dati interni e di terze parti. Il risultato: decisioni più rapide e consapevoli su footprint, gap di copertura e priorità d'investimento.",
        image: "image_3.png",
        link: "#",
        tags: ["GeoIntelligence", "Network Planning", "KPIs", "Location Intelligence"],
        keywords: ["GeoIntelligence","Location Intelligence","KPI","greenfield","scenario","governance","benchmark"]
      },
      {
        title: "E‑commerce Full Potential – Leader globale nel settore eyewear",
        desc: "Program management e‑commerce su Shopify: SEO, integrazioni tecniche, Shopify Payments, espansioni regionali e automazioni marketing.",
        full: "Ho guidato per due anni un programma di potenziamento e‑commerce per un leader globale dell'eyewear. Mi sono occupato della gestione quotidiana delle operation, del miglioramento SEO e del coordinamento delle principali integrazioni tecniche su Shopify. Tra i risultati: attivazione di Shopify Payments, supporto a espansioni regionali e ottimizzazione delle automazioni di marketing. L'iniziativa ha snellito i processi, aumentato la visibilità organica e migliorato gli indicatori di vendita, in linea con i target di ricavo.",
        image: "https://images.unsplash.com/photo-1512295767273-ac109ac3acfa?q=80&w=1600&auto=format&fit=crop",
        link: "#",
        tags: ["E‑commerce", "Shopify", "SEO", "Marketing Automation"],
        keywords: ["Shopify","SEO","Marketing Automation","Payments","espansioni","e‑commerce"]
      },
      {
        title: "CRM & Loyalty – Brand globale nel settore Fashion e Retail",
        desc: "Definizione loyalty (naming, livelli, meccaniche) con business case. Integrazione real‑time POS, analytics e journey automation.",
        full: "Ho definito e implementato un programma CRM & Loyalty per un brand fashion globale: dalla strategia (naming, meccaniche, livelli, punti e reward) al business case per ROI e sostenibilità. Ho coordinato team Data & Analytics e IT per integrare logiche real‑time tra loyalty engine e sistemi cassa in negozio, abilitando segmentazioni in tempo reale. Ho implementato analytics avanzati, workflow di marketing automation e journey ottimizzati, favorendo il passaggio da un approccio transazionale a uno relazionale, con crescita della loyalty e impatto sul business.",
        image: "https://images.unsplash.com/photo-1512436991641-6745cdb1723f?q=80&w=1600&auto=format&fit=crop",
        link: "#",
        tags: ["CRM", "Loyalty", "Customer Journeys", "Real‑time POS"],
        keywords: ["CRM","Loyalty","Real‑time","POS","journey","analytics","automation"]
      },
      {
        title: "Ecosistema Influencer Marketing – Brand globale nel settore caffè",
        desc: "Ecosistema influencer integrato con CRM/MA/e‑commerce, governance HQ‑local, processi scalabili e framework budget/roll‑out.",
        full: "Ho disegnato e implementato un ecosistema di Influencer Marketing per un produttore di macchine da caffè, integrato con CRM, marketing automation ed e‑commerce per semplificare le collaborazioni global/local. Ho definito governance e ruoli per garantire coerenza centrale con adattabilità locale, processi scalabili e strumenti avanzati per l'efficienza operativa. Ho creato un framework di budget e una roadmap di roll‑out per esecuzione puntuale e costo‑efficace. L'allineamento tra persone, processi e asset ha aumentato awareness, conversione e loyalty.",
        image: "https://images.unsplash.com/photo-1498804103079-a6351b050096?q=80&w=1600&auto=format&fit=crop",
        link: "#",
        tags: ["Influencer", "Governance", "Automation", "E‑commerce"],
        keywords: ["Influencer","governance","automation","e‑commerce","roll‑out","budget"]
      }
    ];

    // ======= RENDER MOSAICO =======
    const grid = document.getElementById('mosaic');
    function renderGrid(){
      grid.innerHTML = '';
      projects.forEach((p, i)=>{
        const card = document.createElement('article');
        card.className = 'card';
        card.id = `p-${i}`;
        card.innerHTML = `
          <img src="${p.image}" alt="${p.title}" data-idx="${i}" style="pointer-events:none; cursor:default;" />
          <div class="body">
            <h3>${p.title}</h3>
            <div style="color:var(--muted); font-size:14px">${p.desc}</div>
            <div class="meta">${p.tags.map(t=>`<span class=\"tag\">${t}</span>`).join('')}</div>
            <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap">
              <a class="btn ghost" href="#slides" data-show-slide="${i}">Dettagli</a>
            </div>
          </div>`;
        grid.appendChild(card);
      });
    }

    // Navigazione a slideshow (solo pulsante Dettagli)
    grid.addEventListener('click', (e)=>{
      const showBtn = e.target.closest('[data-show-slide]');
      if(showBtn){
        const i = parseInt(showBtn.getAttribute('data-show-slide'),10);
        if(!Number.isNaN(i)){
          idx = i;
          setView('slides');
          renderSlide();
          document.getElementById('slides').scrollIntoView({behavior:'smooth', block:'start'});
        }
      }
    });

    // ======= SLIDESHOW =======
    const slidesEl = document.getElementById('slides');
    const slideImage = document.getElementById('slideImage');
    const slideTitle = document.getElementById('slideTitle');
    const slideDesc = document.getElementById('slideDesc');
    let idx = 0;

    // Safe escape for regex specials
    function escapeReg(s){ return s.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'); }
    // Evidenzia ANCHE sotto-stringhe (no confini di parola) – case-insensitive
    function highlight(text, words){
      if(!words || !words.length) return text;
      let out = text;
      const used = new Set();
      words.forEach(w=>{
        if(!w) return;
        const key = String(w).toLowerCase();
        if(used.has(key)) return; used.add(key);
        const re = new RegExp(`(${escapeReg(String(w))})`, 'gi');
        out = out.replace(re, '<strong>$1</strong>');
      });
      return out;
    }

    function renderSlide(){
      const p = projects[idx];
      slideImage.src = p.image; slideImage.alt = p.title;
      // Toggle fit mode per progetto (es. CDP "contain" per mostrare tutta la scritta)
      slideImage.classList.toggle('contain', p.fit === 'contain');
      slideTitle.textContent = p.title;
      slideDesc.innerHTML = highlight(p.full, p.keywords || p.tags);
    }

    document.getElementById('prev').onclick = ()=>{ idx = (idx - 1 + projects.length) % projects.length; renderSlide(); };
    document.getElementById('next').onclick = ()=>{ idx = (idx + 1) % projects.length; renderSlide(); };

    // ======= TOGGLE VISTE =======
    const mosaicBtn = document.getElementById('mosaicBtn');
    const slideBtn = document.getElementById('slideBtn');
    const mosaic = document.getElementById('mosaic');
    function setView(view){
      const isMosaic = view === 'mosaic';
      mosaic.style.display = isMosaic ? 'grid' : 'none';
      slidesEl.classList.toggle('active', !isMosaic);
      mosaicBtn.classList.toggle('active', isMosaic);
      mosaicBtn.setAttribute('aria-selected', isMosaic);
      slideBtn.classList.toggle('active', !isMosaic);
      slideBtn.setAttribute('aria-selected', !isMosaic);
      if(!isMosaic) renderSlide();
    }
    mosaicBtn.onclick = ()=> setView('mosaic');
    slideBtn.onclick = ()=> setView('slides');

    // ======= CONTATTI (dialog semplice) =======
    const contactBtn = document.getElementById('contactBtn');
    contactBtn.addEventListener('click', ()=>{
      alert('Contatti\n\nEmail: ferrulli.walter@gmail.com\nLinkedIn: https://www.linkedin.com/in/walter-ferrulli/');
    });

    // ======= INIT =======
    document.getElementById('year').textContent = new Date().getFullYear();
    renderGrid();
    setView('mosaic');

    // ======= SELF-TEST (asserzioni extra) =======
    (function selfTest(){
      try{
        console.assert(typeof renderGrid === 'function', 'renderGrid deve esistere');
        console.assert(document.querySelectorAll('.card').length === projects.length, 'Il mosaico deve avere tante card quanti sono i progetti');
        // tag specifici richiesti
        console.assert(projects[0].tags.includes('Customer Analytics'), 'Il progetto 0 deve includere Customer Analytics');
        console.assert(projects[1].tags.includes('Location Intelligence'), 'Il progetto 1 deve includere Location Intelligence');
        console.assert(!projects[1].tags.includes('Location'), 'Il progetto 1 non deve includere la keyword "Location" semplice');
        // avatar immagine
        const av = document.querySelector('img.avatar');
        console.assert(av && av.getAttribute('src') === 'image_1.jpg', 'L\'avatar deve essere image_1.jpg');
        // Simula click su "Dettagli" del primo progetto
        const firstBtn = document.querySelector('[data-show-slide="0"]');
        if(firstBtn){
          firstBtn.click();
          console.assert(document.getElementById('slideTitle').textContent === projects[0].title, 'Click Dettagli (0) deve aprire lo slideshow sul progetto 0');
        }
        // Verifica highlight (parola composta presente nel testo)
        idx = 0; renderSlide();
        console.assert(document.getElementById('slideDesc').innerHTML.includes('<strong>Customer Data Platform</strong>'), 'Highlight deve evidenziare "Customer Data Platform"');
        // Verifica highlight di SOTTO-STRINGA (es. "form" dentro "Platform")
        const sample = 'This is a Platform test.';
        const h = highlight(sample, ['form']);
        console.assert(h.includes('<strong>form</strong>'), 'Highlight deve evidenziare anche sotto-stringhe ("form" in "Platform")');
        // Verifica immagini del mosaico non cliccabili
        const firstImg = document.querySelector('.card img');
        console.assert(firstImg && getComputedStyle(firstImg).pointerEvents === 'none', 'Le immagini nel mosaico non devono essere cliccabili');
        // Torna a mosaico
        setView('mosaic');
      }catch(err){
        console.error('Self-test fallito:', err);
      }
    })();
  </script>
</body>
</html>
